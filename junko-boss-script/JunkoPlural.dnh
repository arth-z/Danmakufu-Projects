#TouhouDanmakufu[Plural]
#ScriptVersion[3]
#Title["Junko Prototyping - Plural"]
#Text["Code by Squirrelfart [r]Full bossfight eventually..."]
#System["./JunkoSystem.dnh"]
#Background["./JunkoBackground.dnh"]

#include "./func_library.dnh"
#include "./img/ZUNShot_Const.txt"
#include "./JunkoFX.dnh"

let mainTimer = 0;
let bgm;

@Event 
{
  alternative(GetEventType())
    case(EV_PAUSE_ENTER){
      ObjSound_Stop(bgm);
    }
    case(EV_PAUSE_LEAVE){
      ObjSound_Play(bgm); 
    }
}

@Initialize 
{
  bgm = SoundSFX(GetCurrentScriptDirectory() ~ "./sfx/pf-drL.ogg");
  ObjSound_SetSoundDivision(bgm, SOUND_BGM);
  ObjSound_SetRestartEnable(bgm, true);
  ObjSound_SetLoopEnable(bgm, true);
  ObjSound_SetLoopTime(bgm, 0, 300);
  ObjSound_Play(bgm);
  ObjSound_SetVolumeRate(bgm, 100);
  TPlural;
}

@MainLoop 
{
  yield;
}

task TPlural {
  let dir = GetCurrentScriptDirectory();
  let objScene = ObjEnemyBossScene_Create();

  ObjEnemyBossScene_Add(objScene, 0, dir ~ "n_1.dnh");
  ObjEnemyBossScene_Add(objScene, 0, dir ~ "s_1.dnh");
  
  ObjEnemyBossScene_LoadInThread(objScene);
  ObjEnemyBossScene_Regist(objScene);

  while(!Obj_IsDeleted(objScene)){
        yield;
    }
  CloseScript(GetOwnScriptID());
}